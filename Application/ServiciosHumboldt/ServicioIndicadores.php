<?php
/************************************************************************************/
/************************************************************************************/
/************************************************************************************/
session_start();
//include('filtroseguridad.php');
header("content-type: application/json; charset=utf-8");
header("access-control-allow-origin: *");

/************************************************************************************/
/************************************************************************************/
//$estadoRequest = validarRequestPeticionServicio($_GET);
//echo "Estado request final: " . $estadoRequest;
/************************************************************************************/
/************************************************************************************/
$estadoRequest = "true";

if ($estadoRequest == "false")
{
	//*********************************************************
	//*********************************************************
	//Redireccionamos a la página de error
	//Hubo intento de XSS o SQL Injection
	$sentenciaError = obtenerErrorRequest($_GET);
	$mensajeError = "Entrada Sospechosa XSS/SQL Injection Se encontró la palabra [" . $sentenciaError . "]. Emplee la tecla Retroceder del Navegador para regresar y resolver este problema.";
	$_SESSION["mensajeError"] = $mensajeError;
	header('Location: /serviciosweb/paginaerror.php');
	//*********************************************************
	//*********************************************************
}
else
{
		/************************************************************************************/
		/************************************************************************************/
		//5.6.2
		//print json_encode($rows, JSON_UNESCAPED_UNICODE);
		//5.3.3
		$rows = Array();

		$rows["especies"] = (rand(5, 15) * 10000);
		$rows["clasificadas"] = (rand(5, 15) * 10000);
		$rows["amenazadas"] = (rand(5, 15) * 10000);
		$rows["accion"] = (rand(5, 15) * 10000);
		/*************************/
		print utf8_encode(json_encode($rows));
		/************************************************************************************/
		/************************************************************************************/
		// Liberar el identificador de sentencia al cerrar la conexión
		//oci_free_statement($stid);
		//oci_close($conn);
}

/************************************************************************************/
/************************************************************************************/
/************************************************************************************/
/************************************************************************************/
?>